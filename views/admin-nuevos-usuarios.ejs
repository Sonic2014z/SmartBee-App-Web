
<div class="p-6">
  <!-- Grid de dos columnas -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    
    

    <!-- Columna derecha (Formulario) -->
    <div>
      <div class="mb-6 flex items-center gap-3">
        <i class="fas fa-user-edit text-2xl text-[#D17A08]"></i>
        <h2 class="text-xl font-semibold text-gray-800">Agregar usuario</h2>
      </div>

      <form   method="POST" autocomplete="off" id="formulario_registro" class="rounded-xl border border-gray-200 bg-white p-6 shadow-sm">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- ID -->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-1">ID</label>
            <input type="text"  placeholder="Ingrese ID" name="id" id="id"
              class="w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 focus:outline-none" />
          </div>

          <!-- Nombres -->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-1">Nombres</label>
            <input type="text"  placeholder="Ingrese Nombres" name="nombres" id="nombres"
              class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#D17A08] focus:border-[#D17A08]" />
          </div>

          <!-- Apellidos -->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-1">Apellidos</label>
            <input type="text"  placeholder="Ingrese Apellidos" name="apellidos" id="apellidos"
              class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#D17A08] focus:border-[#D17A08]" />
          </div>


          <!--Comuna-->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-1">Comuna</label>
            <input type="text"  placeholder="Ingrese Comuna" name="comuna" id="comuna"
              class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#D17A08] focus:border-[#D17A08]" />
          </div>

          <!-- Rol -->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-1">Rol</label>
            <select  name="rol" id="rol"
              class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#D17A08] focus:border-[#D17A08]">
              <option value="API" >API | APICULTOR</option>
              <option value="ADM">ADM | ADMINISTRADOR</option>
            
            </select>
          </div>

          <!-- Estado -->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-1">Estado</label>
            <select name="estado" id="estado"
              class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#D17A08] focus:border-[#D17A08]">
              <option value="1">Activo</option>
              <option value="0">Inactivo</option>
            </select>
          </div>
        </div>

        <!-- Botones -->
        <div class="mt-8 flex gap-4">
          <button type="submit" 
            class="flex items-center gap-2 rounded-md bg-[#D17A08] px-4 py-2 font-semibold text-white hover:bg-[#b86806] transition">
            <i class="fas fa-save"></i> Guardar
          </button>
        
        </div>
      </form>
    </div>

    
  </div>
</div>


<script>

const formulario = document.getElementById('formulario_registro');
formulario.addEventListener('submit', function(event) {
    event.preventDefault(); // Evita el envÃ­o del formulario por defecto

    // Obtiene los valores de los campos
    const id = document.getElementById('id').value;
    const nombres = document.getElementById('nombres').value;
    const apellidos = document.getElementById('apellidos').value;
    const comuna = document.getElementById('comuna').value;
    const rol = document.getElementById('rol').value;
    const estado = document.getElementById('estado').value;


    if (!id || !nombres || !apellidos || !rol || !estado || !comuna) {
        Swal.fire({
            icon: 'error',
            title: 'Error',
            text: 'Por favor, completa todos los campos.',
            confirmButtonColor: '#d33'
        });
        return;
    
    }else{

        Swal.fire({
  title: "Estas seguro?",
  text: "No podras revertir!",
  icon: "warning",
  showCancelButton: true,
  confirmButtonColor: "#3085d6",
  cancelButtonColor: "#d33",
  confirmButtonText: "Si, Guardar!"
}).then((result) => {
  if (result.isConfirmed) {



     const url = "/admin/usuarios/registrar";

     const usuario = {
        id: id,
        nombres: nombres,
        apellidos: apellidos,
        comuna: comuna,
        rol: rol,
        estado: estado
     }


     fetch(url, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(usuario)
        }).then(response => {
            if (response.ok) {
                return response.json();
            } else {
                throw new Error('Error en la solicitud');
            }
        }).then(data => {
            if (data.success) {
                Swal.fire({
                    title: "Muy bien!",
                    text: "Usuario registrado correctamente!",
                    icon: "success"
                }).then(() => {
                    window.location.href = "/admin/usuarios"; 
                });
            } else {
                Swal.fire({
                    title: "Error",
                    text: data.message || "No se pudo registrar el usuario.",
                    icon: "error"
                });
            }
        }).catch(error => {
            Swal.fire({
                title: "Error",
                text: error.message,
                icon: "error"
            });
        });

  }
});

    }




    
});



</script>